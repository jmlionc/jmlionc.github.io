---
title: "M√≥dulo 4: An√°lisis Descriptivo y Exploratorio"
subtitle: "Bioestad√≠stica Fundamental y Estad√≠stica Fundamental para las Ciencias de la Salud"
author: 
- name: "Jose Miguel Leon Puentes"
  affiliation: "Departamento de Estad√≠stica"
institute: "Universidad Nacional de Colombia"
format:
  html:
    theme: cosmo
    toc: true
    toc-depth: 4
    toc-title: Tabla de Contenido
    other-links:
      - text: Contacto
        icon: mailbox
        href: mailto:joleonp@unal.edu.co
    code-links:
      - text: GitHub
        icon: github
        href: https://github.com/jmlionc/AppliedBiostats

editor: visual
---

## üî∞ Introducci√≥n

::: {style="text-align: justify;"}
En este m√≥dulo se espera introducir al estudiante a una filosof√≠a de razonamiento estad√≠stico a trav√©s de la cual adquirir√° los principios del pensamiento cient√≠fico respecto a la descripci√≥n organizada de los datos, realizando una traducci√≥n de un conjunto de datos en informaci√≥n y hallazgos divulgables por medio de t√©cnicas de potencializaci√≥n del uso de gr√°ficos y obtenci√≥n de √≠ndices. Se presentar√°n los diferentes √≠ndices o estad√≠sticos junto a su respectiva descripci√≥n, f√≥rmula te√≥rica, implementaci√≥n en R e interpretaci√≥n, destacando la importancia de que si bien este material es aplicado y pr√°ctico, resulta inservible de no comprender que m√°s all√° del correcto y √©tico c√°lculo de estas medidas, el cumplimiento de los supuestos requeridos y la interpretaci√≥n es vital, as√≠ como el entendimiento del contexto y de la naturaleza de la distribuci√≥n de nuestros datos.

El m√≥dulo se centra tanto en el c√°lculo num√©rico como en la exploraci√≥n visual, permitiendo que el estudiante desarrolle una mirada cr√≠tica sobre las diferentes maneras de representar la informaci√≥n. A lo largo de este espacio se abordar√°n medidas de tendencia central, medidas robustas y resistentes a valores at√≠picos, medidas de posici√≥n o localizaci√≥n, medidas de dispersi√≥n, medidas de forma (asimetr√≠a y curtosis) y medidas de asociaci√≥n entre dos variables. Paralelamente, se explorar√° el papel de la visualizaci√≥n gr√°fica en la comprensi√≥n de los datos, destacando c√≥mo los gr√°ficos complementan y refuerzan los an√°lisis num√©ricos, y c√≥mo las herramientas de R permiten generar representaciones vers√°tiles, reproducibles y adaptables a diferentes contextos.

Con ello, se busca que el estudiante logre no solo manipular adecuadamente datos en R, sino tambi√©n construir narrativas estad√≠sticas fundamentadas en evidencia, con capacidad de comunicar hallazgos de manera clara, precisa y √©tica en entornos cient√≠ficos y profesionales.
:::

## üéØ Objetivos

-   Comprender el papel del an√°lisis descriptivo y exploratorio como etapa inicial y fundamental del razonamiento estad√≠stico.

<!-- -->

-   Calcular e interpretar medidas de tendencia central, dispersi√≥n, posici√≥n y forma, reconociendo su utilidad y limitaciones.

<!-- -->

-   Incorporar medidas robustas y resistentes para el an√°lisis de datos en presencia de valores at√≠picos.

<!-- -->

-   Analizar relaciones entre dos variables mediante √≠ndices y representaciones gr√°ficas apropiadas.

<!-- -->

-   Utilizar R para implementar de manera pr√°ctica las medidas descriptivas y visualizaciones necesarias para resumir datos.

<!-- -->

-   Fomentar una interpretaci√≥n cr√≠tica y contextualizada de los resultados estad√≠sticos, destacando la importancia de los supuestos y la √©tica en su comunicaci√≥n.

## üìñ Desarrollo

### Medidas de Tendencia Central

#### Media Aritm√©tica

**Descripci√≥n:**\
La media aritm√©tica es el promedio de un conjunto de datos. Se obtiene sumando todos los valores y dividiendo entre el n√∫mero total de observaciones.

**F√≥rmula**

$$
\bar{x} = \frac{1}{n} \sum_{i=1}^{n} x_i
$$

donde $n$ es el n√∫mero de observaciones y $x_i$ cada valor de la variable.

**Implementaci√≥n en R**

```{r}
# Datos de ejemplo
x <- c(5, 7, 8, 9, 10)

mean(x)
```

**Interpretaci√≥n**

La media aritm√©tica indica el valor central promedio de los datos. Es sensible a valores extremos

#### Media Aritm√©tica Ponderada

**Descripci√≥n:**\
Promedio que asigna un peso a cada observaci√≥n para reflejar su importancia relativa.

**F√≥rmula** $$
\bar{x}_p = \frac{\sum_{i=1}^{n} w_i x_i}{\sum_{i=1}^{n} w_i}
$$ **Implementaci√≥n en R**

```{r}
x <- c(3, 5, 7)
w <- c(1, 2, 3)
weighted.mean(x, w, na.rm = TRUE)
```

**Interpretaci√≥n**

Promedio ajustado por importancia; √∫til en calificaciones, √≠ndices y agregaci√≥n de indicadores.

#### Mediana

**Descripci√≥n:**\
Valor central de los datos ordenados; divide la muestra en dos mitades del mismo tama√±o. Es robusta frente a valores at√≠picos.

**F√≥rmula** $$
\tilde{x} =
\begin{cases}
x_{(\frac{n+1}{2})}, & \text{si } n \text{ es impar} \\
\dfrac{x_{(\frac{n}{2})} + x_{(\frac{n}{2}+1)}}{2}, & \text{si } n \text{ es par}
\end{cases}
$$ **Implementaci√≥n en R**

```{r}
x <- c(1, 3, 5, 7, 9, 11)
median(x, na.rm = TRUE)
```

**Interpretaci√≥n**

La mitad de las observaciones est√° por debajo y la otra mitad por encima de la mediana.

#### Moda

**Descripci√≥n:**\
Valor (o valores) m√°s frecuente(s) en el conjunto de datos. Puede no ser √∫nica (bimodal/multimodal) o no existir en datos continuos sin discretizaci√≥n.

**F√≥rmula** $$
\text{Moda} = \arg\max_{v} \; f(v)
$$ donde $f(v)$ es la frecuencia del valor $v$.

**Implementaci√≥n en R**

```{r}
mode_all <- function(v) {
  v <- v[!is.na(v)]
  if (length(v) == 0) return(NA)
  tab <- table(v)
  tab <- tab[tab == max(tab)]
  as.vector(names(tab))
}
x <- c(2, 3, 3, 4, 4, 4, 5, NA)
mode_all(x)
```

**Interpretaci√≥n**

Indica el(los) valor(es) m√°s com√∫n(es). √ötil para variables categ√≥ricas.

#### Media Geom√©trica

**Descripci√≥n:**

Promedio multiplicativo; apropiada para tasas de crecimiento, razones y datos en escala logar√≠tmica. Requiere valores positivos.

**F√≥rmula**

$$
\bar{x}_g = \left( \prod_{i=1}^{n} x_i \right)^{\frac{1}{n}}
= \exp\!\left( \frac{1}{n} \sum_{i=1}^{n} \ln x_i \right)
$$ **Implementaci√≥n en R**

```{r}
x <- c(1.2, 1.5, 0.9, 1.1)  # todos > 0
exp(mean(log(x), na.rm = TRUE))
```

**Interpretaci√≥n**

Resume promedios de cambios relativos; menos afectada por valores grandes que la media aritm√©tica.

#### Media Arm√≥nica

**Descripci√≥n:**

Rec√≠proco del promedio de los rec√≠procos; adecuada para promediar tasas (p. ej., velocidad promedio en tramos iguales).

**F√≥rmula**

$$
\bar{x}_h = \frac{n}{\sum_{i=1}^{n} \frac{1}{x_i}}
$$ **Implementaci√≥n en R**

```{r}
x <- c(40, 60, 80)  # velocidades, tasas > 0
length(x) / sum(1/x)
```

**Interpretaci√≥n**

Da mayor peso a valores peque√±os; √∫til cuando la cantidad fija est√° en el denominador (tiempo por unidad, costo por unidad).

#### Promedio de los Cuartiles

**Descripci√≥n:**

Promedio simple de $Q_1$, $Q_2$ (mediana) y $Q_3$; combina posici√≥n central y dispersi√≥n central.

**F√≥rmula** $$
\bar{x}_{Q} = \frac{Q_1 + Q_2 + Q_3}{3}
$$ **Implementaci√≥n en R**

```{r}
x <- c(1,2,3,4,5,6,7,8,9,10)
qs <- quantile(x, probs = c(0.25, 0.5, 0.75), na.rm = TRUE)
mean(qs)
```

**Interpretaci√≥n**

Medida robusta de tendencia central que considera el comportamiento del 50% central de los datos.

#### Trimedia

**Descripci√≥n:**

Promedio ponderado de (Q_1), mediana ((Q_2)) y (Q_3), con doble peso a la mediana.

**F√≥rmula**

$$
\text{Trimedia} = \frac{Q_1 + 2Q_2 + Q_3}{4}
$$

**Implementaci√≥n en R**

```{r}
x <- c(1,2,3,4,5,6,7,8,9,10)
qs <- quantile(x, probs = c(0.25, 0.5, 0.75), na.rm = TRUE)
(qs[1] + 2*qs[2] + qs[3]) / 4
```

**Interpretaci√≥n**

Equilibra robustez (mediana) y distribuci√≥n intermedia ($Q_1$, $Q_3$); √∫til con asimetr√≠as moderadas.

#### Centrimedia o Media Intercuart√≠lica

**Descripci√≥n:**

Promedio de $Q_1$ y $Q_3$; resume el centro del rango intercuart√≠lico (IQR), ignorando colas.

**F√≥rmula**

$$
\text{Centrimedia} = \frac{Q_1 + Q_3}{2}
$$ **Implementaci√≥n en R**

```{r}
x <- c(1,2,3,4,5,6,7,8,9,10)
qs <- quantile(x, probs = c(0.25, 0.75), na.rm = TRUE)
mean(qs)
```

**Interpretaci√≥n**

Mide el ‚Äúcentro‚Äù del 50% medio de los datos, con poca influencia de valores extremos.

### Medidas de Posici√≥n o Localizaci√≥n

#### Cuantiles

##### Percentiles

**Descripci√≥n:**

Los percentiles dividen un conjunto de datos ordenados en 100 partes iguales. Cada percentil indica el valor debajo del cual se encuentra un porcentaje dado de las observaciones.

**F√≥rmula**

$$P_k = \text{valor de la variable tal que } k\% \text{ de¬†las¬†observaciones¬†son¬†menores¬†o¬†iguales}$$

**Implementaci√≥n en R**

```{r}
datos <- c(4, 7, 10, 15, 20)
percentil_25 <- quantile(datos, probs = 0.25)
percentil_25
```

**Interpretaci√≥n**

Un percentil indica la posici√≥n relativa de un dato dentro de la distribuci√≥n. Por ejemplo, el percentil 25 indica el valor por debajo del cual se encuentra el 25% de los datos.

##### Deciles

**Descripci√≥n:**

Los deciles dividen un conjunto de datos ordenados en 10 partes iguales.

**F√≥rmula** $$D_j = \text{valor de la variable tal que } \dfrac{j}{10} \text{ de las observaciones son menores o iguales}$$ **Implementaci√≥n en R**

```{r}
datos <- c(4, 7, 10, 15, 20)
deciles <- quantile(datos, probs = seq(0.1, 0.9, by = 0.1))
deciles
```

**Interpretaci√≥n**

Los deciles permiten identificar la posici√≥n de los datos en intervalos del 10%. Por ejemplo, el decil 4 corresponde al valor debajo del cual est√° el 40% de los datos.

##### Cuartiles

**Descripci√≥n:**

Los cuartiles dividen un conjunto de datos ordenados en 4 partes iguales de acuerdo con una probabilidad predefinida.

**F√≥rmula** $$Q_k = x_{\left( \frac{k(n+1)}{4} \right)}, \quad k=1,2,3$$

**Implementaci√≥n en R**

```{r}
datos <- c(4, 7, 10, 15, 20)
cuartiles <- quantile(datos, probs = c(0.25, 0.5, 0.75))
cuartiles
```

**Interpretaci√≥n**

Los cuartiles permiten identificar c√≥mo se distribuyen los datos y ayudan a detectar la dispersi√≥n. - Q1 indica el valor que deja por debajo el 25% de los datos. - Q2 (la mediana) divide los datos en dos partes iguales. - Q3 deja por debajo el 75% de los datos. Estos valores son √∫tiles para construir diagramas de caja (boxplots) y analizar la simetr√≠a o la presencia de valores at√≠picos en la distribuci√≥n

### Medidas de Dispersi√≥n o Variabilidad

#### Rango

**Descripci√≥n:**

El rango es la diferencia entre el valor m√°ximo y el valor m√≠nimo de un conjunto de datos.

**F√≥rmula** $$
R = X_{\max} - X_{\min}
$$

**Implementaci√≥n en R**

```{r}
datos <- c(4, 7, 10, 15, 20)
rango <- max(datos) - min(datos)
rango
```

**Interpretaci√≥n**

El rango indica la amplitud total de los datos, es decir, qu√© tan dispersos est√°n entre el valor m√°s bajo y el m√°s alto.

#### Rango Intercuart√≠lico

**Descripci√≥n:**

El rango intercuart√≠lico (RIC) es la diferencia entre el tercer cuartil ($Q_3$) y el primer cuartil ($Q_1$). Mide la dispersi√≥n de los datos centrales (el 50% intermedio), eliminando la influencia de valores extremos o at√≠picos.

**F√≥rmula**

$$ RIC = Q_3 - Q_1 $$

**Implementaci√≥n en R**

```{r}
datos <- c(4, 7, 10, 15, 20, 22, 25, 30, 35, 40)
cuartiles <- quantile(datos, probs = c(0.25, 0.75))
RIC <- cuartiles[2] - cuartiles[1]
RIC
```

**Interpretaci√≥n**

El rango intercuart√≠lico muestra la amplitud donde se encuentra la mitad central de los datos. Un RIC peque√±o indica que los datos centrales est√°n muy agrupados, mientras que un RIC grande refleja mayor dispersi√≥n en la zona central. Adem√°s, es una medida robusta porque no se ve afectada por valores extremos.

#### Mediana de las Desviaciones Absolutas

**Descripci√≥n:**

La mediana de las desviaciones absolutas (MAD) mide la dispersi√≥n de los datos alrededor de la mediana. Es una medida robusta, poco sensible a valores at√≠picos.

**F√≥rmula**

$$
MAD = \text{mediana} \left( \, |X_i - \text{mediana}(X)| \, \right)
$$

**Implementaci√≥n en R**

```{r}
datos <- c(4, 7, 10, 15, 20)
mad_value <- mad(datos, constant = 1) # sin factor de correcci√≥n
mad_value
```

**Interpretaci√≥n**

El MAD refleja la variabilidad t√≠pica respecto a la mediana. Si el MAD es bajo, los datos est√°n muy concentrados cerca de la mediana; si es alto, los datos est√°n m√°s dispersos.

#### Desviaci√≥n Est√°ndar

**Descripci√≥n:**

La desviaci√≥n est√°ndar mide la dispersi√≥n promedio de los datos respecto a la media. Es la medida de variabilidad m√°s usada en estad√≠stica cl√°sica.

**F√≥rmula**

$$
s = \sqrt{\frac{1}{n-1} \sum_{i=1}^{n} (x_i - \bar{x})^2}
$$ **Implementaci√≥n en R**

```{r}
datos <- c(4, 7, 10, 15, 20)
desv_est <- sd(datos)
desv_est
```

**Interpretaci√≥n**

Un valor alto de desviaci√≥n est√°ndar indica que los datos est√°n muy dispersos respecto a la media, mientras que un valor bajo indica mayor concentraci√≥n alrededor de ella.

#### Varianza

**Descripci√≥n:**

La varianza es la medida de dispersi√≥n que indica el promedio de los cuadrados de las desviaciones respecto a la media.

**F√≥rmula**

$$
s^2 = \frac{1}{n-1} \sum_{i=1}^{n} (x_i - \bar{x})^2
$$

**Implementaci√≥n en R**

```{r}
datos <- c(4, 7, 10, 15, 20)
varianza <- var(datos)
varianza
```

**Interpretaci√≥n**

La varianza expresa la dispersi√≥n en unidades cuadradas de la variable. Es √∫til en c√°lculos estad√≠sticos posteriores, aunque menos interpretable directamente que la desviaci√≥n est√°ndar.

#### Estandarizaci√≥n

**Descripci√≥n:**

La estandarizaci√≥n transforma los datos para que tengan media cero y desviaci√≥n est√°ndar uno, permitiendo comparaciones entre variables en diferentes escalas.

**F√≥rmula**

$$
z_i = \dfrac{x_i - \bar{x}}{s}
$$

**Implementaci√≥n en R**

```{r}
datos <- c(4, 7, 10, 15, 20)
datos_estandarizados <- scale(datos)
datos_estandarizados
```

**Interpretaci√≥n**

Los valores estandarizados (z-scores) indican cu√°ntas desviaciones est√°ndar se encuentra cada dato por encima o debajo de la media.

#### Coeficiente de Variaci√≥n

**Descripci√≥n:**

El coeficiente de variaci√≥n (CV) mide la dispersi√≥n relativa dividiendo la desviaci√≥n est√°ndar entre la media. Es √∫til para comparar la variabilidad entre diferentes conjuntos de datos con medias distintas.

**F√≥rmula**

$$
CV = \dfrac{s}{\bar{x}} \times 100\%
$$

**Implementaci√≥n en R**

```{r}
datos <- c(4, 7, 10, 15, 20)
cv <- sd(datos) / mean(datos) * 100
cv
```

**Interpretaci√≥n**

Un CV bajo indica que la variabilidad relativa respecto a la media es peque√±a; un CV alto indica mayor dispersi√≥n en relaci√≥n al promedio de los datos.

### Medidas de Forma

#### Medidas de Asimetr√≠a

##### Coeficiente de Pearson

**Descripci√≥n:**

Mide la asimetr√≠a de una distribuci√≥n a partir de la diferencia entre la media y la moda o mediana.

**F√≥rmula**

$$
A_p = \frac{\bar{x} - \text{Mo}}{s}
\quad \text{o bien} \quad
A_p = \frac{3(\bar{x} - \text{Me})}{s}
$$

**Implementaci√≥n en R**

```{r}
pearson_skewness <- function(x) {
  (mean(x) - median(x)) / sd(x) * 3
}

```

**Interpretaci√≥n**

-   $A_p > 0$: distribuci√≥n sesgada a la derecha (cola larga hacia valores grandes).
-   $A_p < 0$: distribuci√≥n sesgada a la izquierda (cola larga hacia valores peque√±os).
-   $A_p \approx 0$: sim√©trica.

##### Coeficiente de Fisher

**Descripci√≥n:**

Mide la asimetr√≠a bas√°ndose en el tercer momento estandarizado de la distribuci√≥n.

**F√≥rmula**

$$
g_1 = \frac{\frac{1}{n}\sum_{i=1}^{n}(x_i - \bar{x})^3}{s^3}
$$

**Implementaci√≥n en R**

```{r}
library(e1071)
skewness(x, type = 1)  # Fisher
```

**Interpretaci√≥n**

-   $g_1 > 0$: sesgo positivo (cola derecha m√°s larga).
-   $g_1 < 0$: sesgo negativo (cola izquierda m√°s larga).
-   $g_1 = 0$: simetr√≠a perfecta.

##### √çndice de Yule-Bowley

**Descripci√≥n:**

Mide la asimetr√≠a a partir de los cuartiles de la distribuci√≥n.

**F√≥rmula**

$$
A_{YB} = \frac{(Q_3 + Q_1 - 2Q_2)}{Q_3 - Q_1}
$$

**Implementaci√≥n en R**

```{r}
yule_bowley <- function(x) {
  qs <- quantile(x, probs = c(0.25, 0.5, 0.75))
  (qs[3] + qs[1] - 2*qs[2]) / (qs[3] - qs[1])
}
```

**Interpretaci√≥n**

-   $A_{YB} > 0$: distribuci√≥n con cola m√°s pesada hacia la derecha.
-   $A_{YB} < 0$: distribuci√≥n con cola m√°s pesada hacia la izquierda.
-   $A_{YB} = 0$: sim√©trica.

##### √çndice de Kelly

**Descripci√≥n:**

Basado en deciles, mide la asimetr√≠a comparando la distancia de la mediana a los percentiles extremos.

**F√≥rmula**

$$
A_K = \frac{(P_{90} + P_{10} - 2P_{50})}{P_{90} - P_{10}}
$$

**Implementaci√≥n en R**

```{r}
kelly_index <- function(x) {
  ps <- quantile(x, probs = c(0.1, 0.5, 0.9))
  (ps[3] + ps[1] - 2*ps[2]) / (ps[3] - ps[1])
}
```

**Interpretaci√≥n**

-   $A_K > 0$: sesgo a la derecha.
-   $A_K < 0$: sesgo a la izquierda.
-   $A_K = 0$: sim√©trica.

#### Medidas de Curtosis

##### Coeficiente de Apuntamiento de Fisher

**Descripci√≥n:**

La curtosis mide el grado de concentraci√≥n de los datos en torno a la media. El coeficiente de apuntamiento de Fisher compara la forma de la distribuci√≥n con la distribuci√≥n normal.

Curtosis positiva (leptoc√∫rtica): la distribuci√≥n tiene colas m√°s pesadas y mayor concentraci√≥n en la media que la normal.

Curtosis cero (mesoc√∫rtica): la distribuci√≥n tiene una forma similar a la normal.

Curtosis negativa (platic√∫rtica): la distribuci√≥n tiene colas m√°s ligeras y menos concentraci√≥n en la media que la normal.

**F√≥rmula**

$$
g_2 = \frac{\frac{1}{n} \sum_{i=1}^n (x_i - \bar{x})^4}{\left( \frac{1}{n} \sum_{i=1}^n (x_i - \bar{x})^2 \right)^2} - 3
$$

**Implementaci√≥n en R**

```{r}
# Paquete necesario
if (!require(moments)) install.packages("moments")
library(moments)

datos <- c(4, 7, 10, 15, 20)
kurtosis(datos) # por defecto ya usa la definici√≥n de Fisher (resta 3)
```

**Interpretaci√≥n**

Si g2 \> 0: los datos son leptoc√∫rticos (m√°s pico y colas pesadas que la normal).

Si g2 = 0: los datos son mesoc√∫rticos (similar a la normal).

Si g2 \< 0: los datos son platic√∫rticos (menos pico y colas m√°s ligeras).

### Medidas Descriptivas para Dos Variables

#### Medidas de Asociaci√≥n

##### Covarianza

**Descripci√≥n:**

La covarianza mide el grado de variaci√≥n conjunta de dos variables. Indica si tienden a aumentar o disminuir juntas, pero su valor depende de las unidades de medida, lo que dificulta su comparaci√≥n entre estudios.

**F√≥rmula**

$$
\text{Cov}(X,Y) = \frac{1}{n} \sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})
$$

**Implementaci√≥n en R**

```{r}
x <- c(4, 7, 10, 15, 20)
y <- c(3, 6, 9, 12, 18)

cov(x, y)
```

**Interpretaci√≥n**

-   Cov \> 0: ambas variables tienden a crecer juntas.
-   Cov \< 0: cuando una crece, la otra tiende a decrecer.
-   Cov ‚âà 0: no hay relaci√≥n lineal aparente.

##### Coeficiente de Correlaci√≥n de Pearson

**Descripci√≥n:**

Mide la fuerza y direcci√≥n de la relaci√≥n lineal entre dos variables cuantitativas. A diferencia de la covarianza, est√° normalizado entre -1 y 1.

**F√≥rmula**

$$
r_{xy} = \frac{\text{Cov}(X,Y)}{\sigma_X \, \sigma_Y}
$$

**Implementaci√≥n en R**

```{r}
cor(x, y, method = "pearson")
```

**Interpretaci√≥n**

-   r ‚âà 1: fuerte relaci√≥n lineal positiva.
-   r ‚âà -1: fuerte relaci√≥n lineal negativa.
-   r ‚âà 0: ausencia de relaci√≥n lineal.

##### Coeficiente de Correlaci√≥n de Spearman

**Descripci√≥n:**

Es una medida no param√©trica de asociaci√≥n basada en los rangos de los datos. Eval√∫a la relaci√≥n mon√≥tona (creciente o decreciente), sin requerir linealidad ni normalidad.

**F√≥rmula**

$$
\rho = 1 - \frac{6 \sum d_i^2}{n(n^2 - 1)}
$$

**Implementaci√≥n en R**

```{r}
cor(x, y, method = "spearman")
```

**Interpretaci√≥n**

-   œÅ cercano a 1: asociaci√≥n mon√≥tona positiva.
-   œÅ cercano a -1: asociaci√≥n mon√≥tona negativa.
-   œÅ cercano a 0: no hay relaci√≥n mon√≥tona.

##### Coeficiente de Correlaci√≥n de Kendall

**Descripci√≥n:**

Mide la concordancia entre pares de observaciones. Es m√°s robusto que Spearman cuando hay empates.

**F√≥rmula**

$$
\tau = \frac{(N_c - N_d)}{\frac{1}{2}n(n-1)}
$$

**Implementaci√≥n en R**

cor(x, y, method = "kendall")

**Interpretaci√≥n**

-   œÑ \> 0: existe concordancia positiva entre las variables.
-   œÑ \< 0: existe concordancia negativa.
-   œÑ ‚âà 0: no hay asociaci√≥n.

::: callout-note
**Correlation does not imply causation** Spurious relationship $\neq$ Causal Relationship (https://tylervigen.com/spurious-correlations)
:::

##### Coeficiente de Gini

**Descripci√≥n:**

Mide la desigualdad o concentraci√≥n en una distribuci√≥n. Aunque es m√°s com√∫n en econom√≠a (para medir desigualdad de ingresos), tambi√©n se aplica a la concentraci√≥n de cualquier variable.

**F√≥rmula**

$$
G = \frac{\sum_{i=1}^n \sum_{j=1}^n |x_i - x_j|}{2n^2 \bar{x}}
$$

**Implementaci√≥n en R**

```{r}
if (!require(ineq)) install.packages("ineq")
library(ineq)
Gini(x)
```

**Interpretaci√≥n**

-   G = 0: perfecta igualdad (todos tienen el mismo valor).
-   G = 1: m√°xima desigualdad (un individuo concentra todo el valor).
-   Valores intermedios: indican distintos grados de concentraci√≥n/desigualdad.

### Gr√°ficos

#### Herramientas y Plataformas Digitales

[**Data Viz Project**](https://datavizproject.com/ "About Data Viz Project") **-** Copenhagen, Denmark.

Data Viz Project es la biblioteca m√°s grande del mundo de visualizaciones de datos. Re√∫ne m√°s de 160 tipos de visualizaciones (y sigue creciendo), cada una con su definici√≥n, taxonom√≠a y ejemplos, lo que la convierte en la colecci√≥n m√°s completa para encontrar la visualizaci√≥n adecuada e inspirarse.

No est√° dirigido √∫nicamente a analistas de datos, dise√±adores gr√°ficos o usuarios avanzados de hojas de c√°lculo, sino que busca ser un recurso de valor e inspiraci√≥n para cualquier persona que necesite representar datos y explorar nuevas formas de hacerlo: estudiantes, investigadores, periodistas, dise√±adores u otros profesionales.

[**The R Graph Gallery**](https://r-graph-gallery.com/ "About R Graph Gallery") **-** Montpellier, France.

R Graph Gallery es una colecci√≥n de gr√°ficos creados con el lenguaje de programaci√≥n R. Presenta cientos de gr√°ficos organizados en secciones, siempre acompa√±ados de su c√≥digo reproducible. La galer√≠a pone especial √©nfasis en el uso de **tidyverse** y **ggplot2**.

Con m√°s de 400 ejemplos clasificados en cerca de 50 tipos de gr√°ficos siguiendo la taxonom√≠a de *data-to-viz*, constituye la compilaci√≥n m√°s completa de gr√°ficos en R disponible en la web. Cada ejemplo incluye tanto el c√≥digo como una explicaci√≥n detallada de su funcionamiento.

Cada tipo de gr√°fico comienza con un tutorial introductorio que explica su estructura y prop√≥sito. Una vez comprendidos los fundamentos, se ofrecen gu√≠as paso a paso con personalizaciones b√°sicas, para lograr gr√°ficos que no solo representen los datos de manera efectiva, sino que tambi√©n se adapten a las necesidades espec√≠ficas de cada usuario.

[**from Data to Viz**](https://www.data-to-viz.com/ "About Data to Viz") **-** Montpellier, France.

[![Complete decision tree](poster-big.png){fig-align="center"}](https://www.data-to-viz.com/#explore)

[Descargar el poster del √°rbol de decisi√≥n](poster-big.png)

From Data to Viz es una clasificaci√≥n de tipos de gr√°ficos basada en el formato de los datos de entrada. Se presenta como un √°rbol de decisiones que conduce a un conjunto de visualizaciones potencialmente adecuadas para representar un conjunto de datos.

El proyecto se apoya en dos ideas principales:

1.  La mayor√≠a de los an√°lisis de datos pueden resumirse en unos veinte formatos de dataset.

2.  Tanto los datos como el contexto determinan el gr√°fico m√°s apropiado.

La metodolog√≠a consiste en identificar y probar los tipos de gr√°ficos viables para encontrar el que mejor se ajuste a los datos y al prop√≥sito del an√°lisis. Una vez definido este conjunto, la web *data-to-viz.com* orienta hacia la mejor elecci√≥n, advierte sobre errores comunes y siempre ofrece un fragmento de c√≥digo reproducible en R.

Aunque el mundo de la visualizaci√≥n de datos es vasto e inagotable, este proyecto busca ser un punto de partida s√≥lido para quienes necesitan elegir y aplicar gr√°ficos de forma adecuada.

#### Ejemplos de gr√°ficos

Utilizaremos un conjunto de datos con informaci√≥n relacionada a registros de estudiantes que presentaron el examen ICFES en el segundo periodo acad√©mico del a√±o 2022. [Descargar Base de Datos](estudiante_train2.rds)

```{r}
estudiante_train2 <- readRDS("D:/Usuario/Escritorio/Quarto Pubs Applied BioStats/M√≥dulo 4 - Estad√≠stica Descriptiva Exploratoria/estudiante_train2.rds")
```

**Histograma**

```{r}
hist(estudiante_train2$punt_global)
```

**Box-plot o Diagrama de Cajas y Bigotes**

```{r}
boxplot(estudiante_train2$punt_global)
```

**Pie chart o Diagrama de Pastel**

```{r}
library(ggrepel)
library(dplyr)
library(ggplot2)

# Paleta profesional
paleta_profesional <- c(
  "Navy"        = "#1D3557",
  "Steel"       = "#457B9D",
  "AccentBlue"  = "#A8DADC",
  "ForestGreen" = "#2A9D8F"
)

### Variable fami_numlibros ----
fami_numlibros <- estudiante_train2$fami_numlibros

# Extraer y resumir variable
datos_num_libros <- estudiante_train2 |>
  count(categoria = fami_numlibros) |>
  mutate(
    fraccion   = n / sum(n),
    porcentaje = round(fraccion * 100, 1),
    etiqueta   = paste0(porcentaje, "%")
  ) |>
  arrange(desc(fraccion)) |>
  mutate(
    categoria = factor(categoria, levels = categoria),
    pos = cumsum(fraccion) - fraccion/2  # posici√≥n acumulada para etiquetas
  )

# Total de observaciones
total_estudiantes <- 236487

# Colores
colores_libros <- setNames(
  paleta_profesional[c("Navy", "Steel", "AccentBlue", "ForestGreen")],
  levels(datos_num_libros$categoria)
)

# Gr√°fico de dona moderna corregido
plot_num_libros_dona <- ggplot(datos_num_libros, aes(x = 2, y = fraccion, fill = categoria)) +
  geom_col(color = "white", width = 1, show.legend = TRUE) +
  coord_polar(theta = "y") +
  xlim(c(0.5, 2.8)) +  # Aumentado el l√≠mite superior para acomodar etiquetas
  geom_text_repel(
    aes(y = pos, label = etiqueta),
    nudge_x = 0.3,    # Reducido el nudge para mantener etiquetas dentro del √°rea
    direction = "y",   # Forzar direcci√≥n vertical
    segment.size = 0.6,
    segment.color = "gray30",
    color = "black",
    size = 4.5,
    fontface = "bold",
    family = "serif",
    show.legend = FALSE,
    max.overlaps = Inf  # Permitir todas las etiquetas
  ) +
  annotate("text", x = 0, y = 0, 
           label = paste0("Total\n", format(total_estudiantes, big.mark = ",")),
           family = "serif", 
           fontface = "bold",
           size = 6, 
           lineheight = 1.1, 
           color = "#333333") +
  scale_fill_manual(values = colores_libros) +
  labs(
    title = "Distribuci√≥n del N√∫mero de Libros en el Hogar",
    subtitle = "Proporci√≥n de estudiantes seg√∫n el n√∫mero estimado de libros en casa"
  ) +
  theme_void(base_size = 14) +
  theme(
    plot.title = element_text(size = 16, face = "bold", family = "serif", hjust = 0.5),
    plot.subtitle = element_text(size = 13, family = "serif", hjust = 0.5, color = "gray30"),
    legend.title = element_blank(),
    legend.text = element_text(family = "serif", size = 12),
    plot.background = element_rect(fill = "white", color = NA),
    legend.position = "bottom"
  )

plot_num_libros_dona
```

**Gr√°fico de Barra Apicalada**

```{r}
### Variable fami_educacionmadre ----
fami_educacionmadre <- estudiante_train2$fami_educacionmadre
table(fami_educacionmadre)

# Datos Originales
datos_edu_madre <- data.frame(
  categoria = c("Sin Educaci√≥n Superior", "Con Educaci√≥n Superior"),
  valor = c(201621, 34866)
)

# Prepare data
datos_edu_madre <- datos_edu_madre %>%
  mutate(
    fraccion = valor / sum(valor),
    porcentaje = round(fraccion * 100, 1),
    etiqueta = paste0(porcentaje, "%")
  )

# Define color palette (colorblind-friendly, elegant)
colores <- c("Sin Educaci√≥n Superior" = "#ADB5BD", 
             "Con Educaci√≥n Superior" = "#1D3557")

# Plot: 100% Stacked Bar Chart
plot_edu_madres <- ggplot(datos_edu_madre, aes(x = "Educaci√≥n de las Madres", y = fraccion, fill = categoria)) +
  geom_bar(stat = "identity", width = 0.5, color = "white") +
  geom_text(aes(label = etiqueta), 
            position = position_stack(vjust = 0.5), 
            color = "white", size = 5, fontface = "bold") +
  scale_fill_manual(values = colores) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  coord_flip() +
  labs(
    title = "Distribuci√≥n de la Educaci√≥n Superior en las Madres",
    subtitle = "Proporci√≥n de madres con y sin educaci√≥n superior",
    x = NULL, y = NULL, fill = NULL
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(size = 16, face = "bold", family = "serif", hjust = 0.5),
    plot.subtitle = element_text(size = 13, family = "serif", hjust = 0.5, color = "gray30"),
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    panel.grid = element_blank(),
    legend.position = "bottom",
    legend.text = element_text(size = 12, family = "serif"),
    plot.background = element_rect(fill = "white", color = NA)
  )
#ggsave(plot_edu_madres, 
#       filename = "plot_edu_madres.pdf",  # Para guardar el gr√°fico generado.
#       device = "pdf")
plot_edu_madres
```

**Gr√°fico de Barras**

```{r}
### Variable fami_estratovivienda ----

# Extraer y resumir variable
fami_estratovivienda <- estudiante_train2 %>%
  count(categoria = fami_estratovivienda) %>%
  mutate(
    fraccion = n / sum(n),
    porcentaje = round(fraccion * 100, 1),
    etiqueta = paste0(porcentaje, "%")
  ) %>%
  mutate(
    categoria = factor(categoria, levels = categoria)  # establecer niveles en ese orden
  )

# Color palette for 4 categories (from your `paleta_profesional`)
colores_estratos <- setNames(
  paleta_profesional[c(
    "Navy", "Steel", "AccentBlue", "ForestGreen",
    "Amber", "Beige", "MediumGray"
  )],
  levels(fami_estratovivienda$categoria)
)

# Plot

# Configuraci√≥n esencial del gr√°fico de barras
plot_estratos <- ggplot(fami_estratovivienda, 
                          aes(x = categoria, y = fraccion, fill = categoria)) +
  geom_col(width = 0.7, color = "white") +
  geom_text(aes(label = etiqueta), 
            vjust = -0.3,
            color = "black", size = 4.5, fontface = "bold", family = "serif") +  # Fuente serif en etiquetas
  scale_fill_manual(values = colores_estratos) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1),
                     expand = expansion(mult = c(0, 0.1))) +
  labs(
    title = "Distribuci√≥n del Estrato del Hogar del Estudiante",
    subtitle = "Proporci√≥n de estudiantes seg√∫n el estrato de la vivienda",
    x = "Estratificaci√≥n Socioecon√≥mica", 
    y = "Porcentaje"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(size = 16, face = "bold", family = "serif", hjust = 0.5),
    plot.subtitle = element_text(size = 13, family = "serif", hjust = 0.5, color = "gray30"),
    # Cambiar fuentes de ejes a serif
    axis.title = element_text(family = "serif", size = 13),              # T√≠tulos de ejes
    axis.text.x = element_text(family = "serif", size = 12),             # Texto eje X (categor√≠as)
    axis.text.y = element_text(family = "serif", size = 12),             # Texto eje Y (porcentajes)
    panel.grid.major.x = element_blank(),
    panel.grid.minor.y = element_blank(),
    panel.grid.major.y = element_line(linetype = "dotted", linewidth = 1),  # L√≠neas de referencia
    legend.position = "none",
    plot.background = element_rect(fill = "white", color = NA)
  )

# Guardar
#ggsave(plot_estratos,
#       filename = "plot_estratos2.pdf",
#       device = "pdf")

plot_estratos
```

## üóÇÔ∏è Tarea y Repaso

::: {style="text-align: center;"}
Copyright ¬© 2025 Jose Miguel Leon - Created with [Quarto](https://quarto.org)
:::
